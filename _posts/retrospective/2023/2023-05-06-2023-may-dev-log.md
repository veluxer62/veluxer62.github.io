---
layout: single
title: "2023ë…„ 4ì›” ê°œë°œì¼ì§€"
categories:
  - RETROSPECTIVE
tags:
  - ê°œë°œì¼ì§€
toc: true
---

ë“œë””ì–´(?) ê·¸ë™ì•ˆ ì¤€ë¹„í•´ì˜¤ë˜ ì±…ì´ ì¶œíŒë˜ì—ˆë‹¤. ì‚¬ì‹¤ ì›ê³ ëŠ” ì‘ë…„ì— ì™„ì„±í•˜ì˜€ëŠ”ë°, ë””ìì¸ê³¼ ë³´ì •ì‘ì—…ì´ ìƒê°ë³´ë‹¤ ê¸¸ì–´ì ¸ì„œ ì´ì œì„œì•¼ ë‚˜ì˜¤ê²Œ ë˜ì—ˆë‹¤. ì–¸ì–´ì „í™˜ì´ë¼ëŠ” ì‚¬ë¡€ë¥¼ ë“¤ê³ ëŠ” ìˆì§€ë§Œ ì „ë°˜ì ì¸ í”„ë¡œì íŠ¸ ê´€ë¦¬ì— ëŒ€í•œ ë‚´ìš©ì„ ë‹´ê³  ìˆì–´ì„œ ë…ìë“¤ì´ ì´ë¶€ë¶„ì— ê´€ì‹¬ì„ ë§ì´ ê°€ì ¸ì£¼ì—ˆìœ¼ë©´ í•˜ëŠ” ë°”ë¨ì´ë‹¤. ì–¸ì–´ì „í™˜ì´ë¼ëŠ” ì‚¬ë¡€ê°€ ëˆ„êµ°ê°€ì—ê²ŒëŠ” ë¶ˆí¸í•  ìˆ˜ë„ ìˆëŠ” ê²ƒì´ë¼ ì¡°ê¸ˆ ìš°ë ¤ê°€ ë˜ê¸°ë„ í•˜ì§€ë§Œ... ì˜íŒ”ë¦¬ëŠ” ê²ƒë³´ë‹¤ë„ ë…¼ë€ê±°ë¦¬ê°€ ì—†ì—ˆìœ¼ë©´ í•˜ëŠ”ê²Œ ë‚´ ë°”ë¨ì´ë‹¤ (~~ì˜íŒ”ë¦¬ë©´ ë” ì¢‹ê³ !~~) ^^;;

íŒë§¤ ë§í¬

- YES24: [http://www.yes24.com/Product/Goods/118474432](http://www.yes24.com/Product/Goods/118474432){: target="\_blank" }
- êµë³´ë¬¸ê³ : [https://product.kyobobook.co.kr/detail/S000201513668](https://product.kyobobook.co.kr/detail/S000201513668){: target="\_blank" }
- ì•Œë¼ë”˜: [https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=315185582](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=315185582){: target="\_blank" }

![my_book](/assets/images/retrospective/my_book.jpeg)

<br/>

ì£¼ë§ì— ì¶˜ì²œ ë¼ì´ë”©ì„ ë‹¤ë…€ì™”ë‹¤. ë²šê½ƒì´ ë§Œê°œí•œ ì£¼ë§ì— ê°”ë”ë¼ë©´ í›¨ì”¬ ë” ì¢‹ì•˜ê² ì§€ë§Œ í•´ë‹¹ ì£¼ì—ëŠ” ì²˜ê°€ëŒì— ë‹¤ë…€ì˜¤ëŠë¼ ë²šê½ƒì´ ë‹¤ ì§„ 4ì›” 2ì§¸ì£¼ì—ë‚˜ ë‹¤ë…€ì˜¬ ìˆ˜ ìˆì—ˆë‹¤. ì„œìš¸ì—ì„œ ì¶˜ì²œì€ ì•½ 100KM ì •ë„ ë˜ëŠ” ê±°ë¦¬ì¸ë° í¸ë„ë¼ë©´ ë¶€ë‹´ì—†ì´ ê°ˆ ìˆ˜ ìˆê³  ëŒì•„ì˜¬ ë•Œ ì§€í•˜ì² ì„ íƒ€ë©´ í¸ë¦¬í•˜ê²Œ ì˜¬ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì¤‘ê±°ë¦¬ ë¼ì´ë”©í•˜ê¸°ì— ë”± ì¢‹ì€ ì½”ìŠ¤ì´ë‹¤. ê°€ëŠ”ê¸¸ì— 10ëª…ì •ë„ ë˜ëŠ” ìì „ê±° íŒ©ì— íƒ‘ìŠ¹í•´ì„œ ê°”ëŠ”ë°, ë•ë¶„ì— ì²´ë ¥ì„ ë§ì´ ì•„ë‚„ ìˆ˜ ìˆì—ˆë‹¤. ì—­ì‹œ í˜¼ìíƒ€ëŠ” ê²ƒë³´ë‹¨ ì—¬ëŸ¿ì´ì„œ íƒ€ëŠ”ê²Œ ì¬ë°ŒëŠ”ë°...ë™ì•„ë¦¬ë¥¼ ë“¤ì–´ê°€ëŠ”ê±´ ì†”ì§íˆ ì•„ì§ë„ ë¶€ë‹´ìŠ¤ëŸ½ë‹¤ ^^;;

![chun_cheon_riding](/assets/images/retrospective/chun_cheon_riding.jpeg)

<br/>

íšŒì‚¬ì—ì„œ ì‘ë…„ì— ì´ì–´ ì˜¬í•´ë„ ë¦¬í”„ë ˆì‹œë°ì´ë¥¼ ì£¼ì—ˆë‹¤. ìµœê·¼ì— ìˆ˜í–‰í–ˆë˜ í”„ë¡œì íŠ¸ì—ì„œ ë§ë„ ë§ê³  íƒˆë„ ë§ì•˜ëŠ”ë° í•´ë‹¹ í”„ë¡œì íŠ¸ê°€ ëë‚˜ê³  ë¦¬í”„ë ˆì‹œë°ì´ë¥¼ ì¤Œìœ¼ë¡œì¨ ì‚¬ê¸°ë¥¼ ë¶ë‹ê¸° ìœ„í•¨ì´ë¦¬ë¼ ìƒê°ì´ ë“ ë‹¤. ì‘ë…„ì—ëŠ” ë°±ì—”ë“œ ì±•í„°ë¼ë¦¬ ê¿‰ë‹¹ì— ê³ ê¸°ë¥¼ êµ¬ì–´ë¨¹ìœ¼ëŸ¬ ê°”ì—ˆëŠ”ë°, ì´ë²ˆì—ëŠ” ë§ˆìŒ ë§ëŠ” ì‚¬ëŒë¼ë¦¬ ë“±ì‚°ì„ ê°€ê¸°ë¡œ í–ˆë‹¤. ì‚¬ì‹¤ ëª©ì ì€ ë“±ì‚° í›„ ë§‰ê±¸ë¦¬ í•œì”í•˜ëŠ”ê²Œ ëª©ì ì´ê¸´ í–ˆë‹¤ ã…‹ã…‹ã…‹

ìš©ë§ˆì‚°ì„ ì˜¤ë¥´ê¸°ë¡œ í–ˆëŠ”ë° ë„ˆë¬´ ë†’ì§€ë„ ì•Šê³  ë“±ì‚°ë¡œê°€ ì˜ë˜ì–´ìˆì–´ì„œ ìƒ¤ë°©í•˜ê²Œ(?) ê°€ê¸° ë”± ì¢‹ì•˜ë˜ ê²ƒ ê°™ë‹¤. ë“±ì‚° í›„ ë‚´ë ¤ì™€ì„œ ë‘ë¶€ê¹€ì¹˜ì— ë§‰ê±¸ë¦¬ë„ ë§ˆì‹œê³  ë³´ë“œì¹´í˜ì—ì„œ ê²Œì„ë„í•˜ê³  3ì°¨ì—ì„œ ì–‘ê¼¬ì¹˜ì— ê³ ëŸ‰ì£¼ë„ ë§ˆì‹œê³  ì•„ì£¼ ì•Œì°¨ê²Œ(?) ë†€ì•˜ë‹¤.

![yongma_mountain](/assets/images/retrospective/yongma_mountain.jpeg)

<br/>

ì½”ë¡œë‚˜ê°€ ì ì  ì¢…ì‹ë˜ë©´ì„œ ë‹¤ë“¤ ê·¸ë™ì•ˆ ë¯¸ë¤„ì™”ë˜ ê²°í˜¼ì‹ì„ ì˜¬ë¦¬ëŠ” ê²ƒ ê°™ë‹¤. íŠ¹íˆ 4ì›”ì€ ê²°í˜¼ì‹ì´ ë§ì€ ë‹¬ì´ì—ˆëŠ”ë° ë‚˜ë„ ê·¸ë ‡ê³  ì•„ë‚´ë„ ê·¸ë ‡ê³  ì„œë¡œ ê²°í˜¼ì‹ì— ì°¸ê°€í•˜ëŠë¼ ì£¼ë§ì—ëŠ” ê±°ì˜ ì‰¬ì§€ë„ ëª»í•˜ëŠ” ê²ƒ ê°™ë‹¤.

ìµœê·¼ì— ì¹œí•œ í˜•ì´ ë¶€ì‚°ì—ì„œ ê²°í˜¼ì‹ì´ ìˆì–´ ì„œìš¸ì— ì‚¬ëŠ” ì¹œêµ¬ë“¤ê³¼ ë¶€ì‚°ì— ê°™ì´ ë‚´ë ¤ê°”ë‹¤. ì‚¼ì„±ì— ë‹¤ë‹ˆëŠ” ì¹œêµ¬ë“¤ì´ë¼ í•´ìš´ëŒ€ì— ìˆëŠ” í•œí™”ë¦¬ì¡°íŠ¸ì—ì„œ ë¬µì—ˆëŠ”ë° ëŒ€ê¸°ì—… ë‹¤ë‹ˆëŠ” ì¹œêµ¬ë“¤ ë•ë¶„ì— ê´‘ì•ˆëŒ€êµê°€ ë³´ì´ëŠ” ìˆ™ì†Œì—ì„œ ë¬µëŠ” í˜¸ì‚¬(?)ë¥¼ ëˆ„ë¦´ ìˆ˜ ìˆì—ˆë‹¤.

ì„œìš¸ì‚¬ëŠ” ì¹œêµ¬ë“¤ ì´ì•¼ê¸°ë¥¼ ë“¤ì–´ë³´ë‹ˆ íšŒì‚¬ì— ë¶€ì‚°ìœ¼ë¡œ ë°œë ¹ì„ ë°›ì„ ìˆ˜ ìˆëŠ”ì§€ ë¬¸ì˜í•´ ë†“ì€ ìƒíƒœë¼ê³  í•œë‹¤. ì´ì „ì— ë¶€ì‚°ì—ì„œ ëŒ€í•™ì„ ë‹¤ë‹ë•Œì—ëŠ” ëª°ëëŠ”ë° ì„œìš¸ì‚´ì´ë¥¼ í•˜ë‹¤ê°€ ë¶€ì‚°ì— ì˜¤ë‹ˆ ë°”ë‹¤ë„ ë„ˆë¬´ ì¢‹ê³  ë­”ê°€ ëª¨ë¥¼ ì—¬ìœ ë¡œì›€ì´ ë„ˆë¬´ ì¢‹ì•˜ë‹¤. ê·¸ë˜ì„œ ì¹œêµ¬ë“¤ë„ ë¶€ì‚°ìœ¼ë¡œ ê°€ë ¤ê³  í•˜ì§€ ì•Šì•˜ì„ê¹Œ ìƒê°ëœë‹¤. ë§Œì•½ì— ìš°ë¦¬ íšŒì‚¬ë„ ì›Œì¼€ì´ì…˜ì´ ê°€ëŠ¥í–ˆë”ë¼ë©´ ë¶€ì‚°ì—ì„œ í•œë™ì•ˆ ì§€ë‚´ëŠ”ê²ƒë„ ìƒê°í•´ ë´„ì§í–ˆì„ í…ë° ê·¸ëŸ¬ì§€ ëª»í•´ì„œ ì•„ì‰¬ìš´ ë§ˆìŒì´ë‹¤.

<br/>

ìš”ê¸ˆ êµ¬í˜„í•´ë³¸ì ì´ ì—†ëŠ” API ì„¤ê³„ë¼ë˜ì§€ êµ¬ê¸€ë§ì„ í†µí•´ ì›í•˜ëŠ” ë°”ë¥¼ ì°¾ì§€ ëª»í–ˆì„ ë•Œ íŒíŠ¸ë¥¼ ì–»ê¸°ìœ„í•´ì„œ ChatGPTë¥¼ ë§ì´ í™œìš©í•˜ê³  ìˆë‹¤. ì•„ì§ ChatGPTì—ì„œ ì œì•ˆí•´ì£¼ëŠ” ì½”ë“œë“¤ì„ ê·¸ëŒ€ë¡œ í™œìš©í•˜ê¸´ ì–´ë µì§€ë§Œ í‚¤ì›Œë“œ ì¡°ì°¨ ì•Œê¸° ì–´ë ¤ì›Œì„œ êµ¬ê¸€ë§ì„ í†µí•´ ì •ë³´ë¥¼ ì°¾ê¸° ì–´ë ¤ì› ë˜ ê²ƒë“¤ì„ ë§ì´ í•´ê²°í•  ìˆ˜ ìˆì–´ì„œ ì¢‹ì•˜ë‹¤. ìœ ë£Œ ë²„ì „ì„ ì‚¬ìš©í•˜ë©´ ì¢€ë” ë†’ì€ í€„ë¦¬í‹°ì˜ ë‹µë³€ì„ ë°›ì„ ìˆ˜ ìˆë‹¤ê³  í•˜ëŠ”ë° ì‚¬ì‹¤ ë¬´ë£Œë²„ì „ë§Œìœ¼ë¡œë„ ì¶©ë¶„íˆ ë§Œì¡±í•˜ê³  ìˆì–´ì„œ ì•„ì§ê¹Œì§€ëŠ” ìœ ë£Œë²„ì „ì„ ê²°ì œí•  ìƒê°ì€ ì—†ë‹¤.

ìµœê·¼ì— [ê²½ìˆ˜ë‹˜ ë§Œí™”](https://www.instagram.com/waterglasstoon/){: target="\_blank" }ë¥¼ ë³´ë‹¤ê°€ ChatGPT ê´€ë ¨ ì´ì•¼ê¸°ê°€ ìˆì–´ì„œ ì˜¬ë ¤ë³¸ë‹¤ ã…‹ã…‹ ë¼ë–¼(?)ëŠ” ì§„ì§œ Stackoverflowê°€ ë§Œë³‘í†µì¹˜ì•½ì´ì—ˆëŠ”ë° ì´ì œëŠ” ChatGPTë¡œ ë°”ë€Œì§€ ì•Šì„ê°€ ìƒê°ëœë‹¤.

![chat_gpt_meme](/assets/images/retrospective/chat_gpt_meme.jpeg)

<br/>

ë™ë£Œ ê°œë°œìë¶„ê»˜ì„œ 3D í”„ë¦°í„°ë¥¼ ì´ìš©í•˜ì—¬ í‚¤ë³´ë“œë¥¼ ì œì‘í•˜ì‹œëŠ”ë° ì¢‹ì•„ë³´ì—¬ì„œ í•˜ë‚˜ ì¥ë§Œí–ˆë‹¤. ì†”ì§íˆ í‚¤ ë°°ì—´ì´ ìµìˆ™ì¹˜ ì•Šì•„ì„œ ì ì‘í•˜ê¸°ê¹Œì§€ ë‹¤ì†Œ ì‹œê°„ì´ ê±¸ë¦´ê±° ê°™ì§€ë§Œ ê°€ë³ê³  íœ´ëŒ€í•˜ê¸° ì¢‹ì„ê±° ê°™ì•„ì„œ í•˜ë‚˜ ì‚¬ë³´ì•˜ë‹¤.

ì¬ë¯¸ìˆëŠ”ê±´ í‚¤ë°°ì—´ì„ ì½”ë“œë¡œ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì¸ë° [Github](https://github.com/veluxer62/keyboard){: target="\_blank" }ì— í‚¤ë°°ì—´ ê°’ì„ ì €ì¥í•´ë‘ê³  mainì— ë³‘í•©í•˜ë©´ í‚¤ë§µ ì„¤ì • íŒŒì¼ì„ ë‹¤ìš´ ë°›ì„ ìˆ˜ ìˆê³  í‚¤ë³´ë“œì— ì ìš©í•˜ë©´ ë°”ë¡œ ë³€ê²½í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

3ì£¼ ì •ë„ ì‚¬ìš©í•˜ë‹ˆ ì¡°ê¸ˆ ì ì‘í• ë§Œí•œê±° ê°™ì€ë° ì—¬ì „íˆ ìƒì‚°ì„±ì´ ë°˜í† ë§‰ë‚œ ìƒíƒœì´ê¸´ í•˜ë‹¤ ^^;;

![keyboard](/assets/images/retrospective/keyboard.jpeg)

<br/>

ì•„ë˜ëŠ” 4ì›”ë™ì•ˆ ì •ë¦¬í•œ ì´ìŠˆ ë‚´ìš©ë“¤ì´ë‹¤.

## ê¸°ëŠ¥í…ŒìŠ¤íŠ¸ì—ì„œì˜ JMS ì´ìŠˆ

í…ŒìŠ¤íŠ¸ì—ì„œ JMSë¥¼ ì´ìš©í•œ ë©”ì‹œì§€ ì „ì†¡ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹œ ì´ìŠˆê°€ ìˆì—ˆë‹¤. MockServerë¥¼ ì´ìš©í•˜ëŠ”ë° verifyê°€ ê³„ì† ë˜ì§€ ì•ŠëŠ” í˜„ìƒì´ ì§€ì†ë˜ì—ˆëŠ”ë° ì›ì¸ì„ ì°¾ì•„ë³´ë‹ˆ JMSë¡œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•˜ë©´ expectationì´ ê¸°ë¡ë˜ì§€ ì•ŠëŠ” í˜„ìƒì´ ìƒê¸°ëŠ” ê²ƒì„ ë°œê²¬í•  ìˆ˜ ìˆì—ˆë‹¤.

ì˜ì‹¬ê°€ëŠ” ë¶€ë¶„ì´ ìƒê²¼ìœ¼ë‹ˆ ì•„ë˜ì™€ ê°™ì´ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ì•˜ë‹¤.

```kotlin
class FooTest(
    private val fooService: FooService,
) : FunctionalTestBase() {
    init {
        test("test") {
            mockery.sendSendbirdUserMessageToGroupChannel()
            fooService.test()
            mockery.verifySendUserMessageToGroupChannel("", "", ORDER_WELCOME_CUSTOM_TYPE, "")
        }
    }
}

@Service
class FooService(
    private val jmsTemplate: JmsTemplate,
) {
    fun test() {
        jmsTemplate.convertAndSend("foo.test", "send test")
    }
}

@Component
class FooListener(
    private val sendbirdApi: SendbirdApi
) {
    @JmsListener(destination = "foo.test")
    fun handle(event: String) {
        val payload = SendbirdSendUserMessagePayload(
            message = """
                ì•ˆë…•í•˜ì„¸ìš”. í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤. ì²« ì£¼ë¬¸ì„ ë³´ë‚´ì£¼ì„¸ìš”!

                ğŸ›’ ì£¼ë¬¸ ê°€ì´ë“œ : bit.ly/3R3tDyb

                ğŸ’¬ ê¶ê¸ˆí•œ ë‚´ìš©ì´ ìˆìœ¼ë©´ ì±„íŒ…ìœ¼ë¡œ ë¬¼ì–´ë³´ì„¸ìš”.
            """.trimIndent(),
            customType = ORDER_WELCOME_CUSTOM_TYPE,
            userId = "",
            data = "",
        )

        sendbirdApi.sendUserMessageToGroupChannel(
            groupChannelUrl = event,
            payload = payload,
        )
    }
}

```

ì—­ì‹œ ì‹¤íŒ¨í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. JMSê°€ ê¸°ë³¸ì ìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ ë™ê¸°ì ìœ¼ë¡œ ì „ì†¡í•˜ë„ë¡ ì„¤ì •(ì°¸ê³ : [https://activemq.apache.org/how-do-i-enable-asynchronous-sending](https://activemq.apache.org/how-do-i-enable-asynchronous-sending){: target="\_blank" }) í•œë‹¤ê³ ëŠ” í•˜ì§€ë§Œ MockServerì—ì„œ Expectationì´ ê¸°ë¡ë˜ì§€ ì•ŠëŠ” ì´ìœ ëŠ” ì •í™•í•˜ê²Œ ëª¨ë¥´ê² ë‹¤.
ê·¸ë˜ì„œ Awaitë¥¼ ê±¸ì–´ ê²€ì¦í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ í•´ê²°í•˜ì˜€ë‹¤.

```kotlin
test("test") {
    mockery.sendSendbirdUserMessageToGroupChannel()
    fooService.test()
    Awaitility.await().atMost(Duration.ofSeconds(2)).untilAsserted {
        mockery.verifySendUserMessageToGroupChannel("", "", ORDER_WELCOME_CUSTOM_TYPE, "")
    }
}
```

ìœ„ì™€ ê°™ì€ ë°©ë²• ë§ê³ ë„ Kotestì—ì„œ ì œê³µí•˜ëŠ” [`Eventually`](https://kotest.io/docs/assertions/eventually.html){: target="\_blank" }ë¥¼ í™œìš©í•  ìˆ˜ë„ ìˆë‹¤.

```kotlin
test("test") {
    mockery.sendSendbirdUserMessageToGroupChannel()
    fooService.test()

    eventually(2.seconds) {
        mockery.verifySendUserMessageToGroupChannel("", "", ORDER_WELCOME_CUSTOM_TYPE, "")
    }
}
```

## unleash

ê´€ë¦¬ìì— [Unleash](https://docs.getunleash.io/){: target="\_blank" }ë¥¼ ì ìš©í•´ì„œ Breaking Changeê°€ ë°œìƒí•˜ëŠ” ë°°í¬ê°€ ìˆì„ ë•Œ ê³µì‚¬ì¤‘ í˜ì´ì§€ë¥¼ ë„ì›Œì„œ ì‚¬ìš©ìê°€ ì ‘ì†í•˜ì§€ ëª»í•˜ë„ë¡ ë§‰ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í–ˆë‹¤.

![admin_renewal_page](/assets/images/retrospective/admin_renewal_page.png)

## ì¢‹ì€ ì„œë¹„ìŠ¤ ë””ìì¸

ì‚¬ë‚´ ì›Œí¬ìƒµì—ì„œ ì¢‹ì€ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•œ ë””ìì¸ì´ë¼ëŠ” ì£¼ì œë¡œ ë°œí‘œë¥¼ í•˜ì˜€ëŠ”ë° ë‚´ìš©ì´ ì¢‹ì•„ì„œ ì¢‹ì€ ì„œë¹„ìŠ¤ ë””ìì¸ì˜ 15ê°€ì§€ ì›ì¹™ë§Œ ì ì–´ë³¸ë‹¤.

ì¢‹ì€ ì„œë¹„ìŠ¤ëŠ”
- ì°¾ê¸° ì‰½ë‹¤.
- ëª©ì ì„ ë¶„ëª…í•˜ê²Œ ì„¤ëª…í•œë‹¤.
- ì‚¬ìš©ìì˜ ê¸°ëŒ€ì¹˜ë¥¼ ì„¤ì •í•œë‹¤.
- ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì–»ë„ë¡ ë§Œë“ ë‹¤.
- ì¹œìˆ™í•œ ë°©ì‹ìœ¼ë¡œ ê¸°ëŠ¥í•œë‹¤.
- ì‚¬ì „ ì§€ì‹ì´ ì—†ì–´ë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- ì¡°ì§ì˜ êµ¬ì¡°ì™€ ë¬´ê´€í•˜ë‹¤.
- ìµœì†Œí•œì˜ ë‹¨ê³„ë§Œ í•„ìš”ë¡œ í•œë‹¤.
- ì „ì²´ì ìœ¼ë¡œ ì¼ê´€ì„± ìˆë‹¤.
- ë§‰í˜ì´ ì—†ë‹¤.
- ëª¨ë“  ì‚¬ëŒì´ ë™ë“±í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- ì‚¬ìš©ìì™€ ì§ì›ì´ ì˜¬ë°”ë¥¸ í–‰ë™ì„ í•˜ë„ë¡ ì¥ë ¤í•œë‹¤.
- ë³€í™”ì— ë¹ ë¥´ê²Œ ëŒ€ì‘í•œë‹¤.
- ê²°ì •ì˜ ì´ìœ ë¥¼ ëª…í™•íˆ ì„¤ëª…í•œë‹¤.
- ë„ì›€ì„ ë°›ëŠ” ê²ƒì´ ì‰½ë‹¤.

## Dynaimc Multi Tenancy in JPA

JPAì—ì„œ ì¡°ì§ë³„ë¡œ ìŠ¤í‚¤ë§ˆë¥¼ ë‹¤ë¥´ê²Œ ìš´ì˜í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê¸°ëŠ¥ì„ ê°œë°œí•´ë³´ì•˜ë‹¤. JPAì—ì„œëŠ” Entityë¥¼ ë¶„ì„í•´ì„œ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•  ë•Œ `StatementInspector`ë¥¼ í†µí•´ì„œ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•´ì£¼ëŠ”ë° ì´ë¥¼ ì´ìš©í•˜ë©´ ì†ì‰½ê²Œ ì¡°ì§ë³„ë¡œ ë‹¤ë¥¸ ìŠ¤í‚¤ë§ˆì— ì¿¼ë¦¬ë¥¼ ë³€ê²½í•´ì„œ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆë‹¤.

```kotlin
class DynamicCatalogNameInterceptor : StatementInspector {
    override fun inspect(sql: String): String {
        val authentication = SecurityContextHolder.getContext().authentication

        return if (authentication != null) {
            val principal = authentication.principal as SecurityUser
            sql.replace("###catalog_name###", principal.catalogName)
        } else {
            sql
        }
    }
}
```

ì—¬ê¸°ì„œ ì‹ ê²½ì¨ì•¼í•  ë¶€ë¶„ì€ ìœ„ì— ì¸í„°í˜ì´ìŠ¤ë¥¼ ì •ì˜í•´ë„ Hibernateê°€ í•´ë‹¹ Interceptorë¥¼ ì ìš©í•´ì£¼ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì´ë‹¤. ê·¸ë˜ì„œ ì•„ë˜ì™€ ê°™ì´ ì„¤ì •ì„ í•´ì£¼ì–´ì•¼ í•œë‹¤.

```yml
spring:
  jpa:
    properties:
      hibernate.session_factory.statement_inspector: com.example.demo.DynamicCatalogNameInterceptor
```

POCì— ëŒ€í•œ ì½”ë“œëŠ” [Github](https://github.com/veluxer62/multi-tenant-per-schema-poc-with-jpa){: target="\_blank" }ì—ì„œ í™•ì¸í•´ ë³´ê¸¸ ë°”ë€ë‹¤.

## ë‹¹ì‹ ì´ ì„±ì¥í•˜ì§€ ëª»í•˜ëŠ” ì´ìœ 

ìµœê·¼ì— [ë‹¹ì‹ ì´ ì„±ì¥í•˜ì§€ ëª»í•˜ëŠ” ì´ìœ ](https://www.popit.kr/%eb%8b%b9%ec%8b%a0%ec%9d%b4-%ec%84%b1%ec%9e%a5%ed%95%98%ec%a7%80-%eb%aa%bb%ed%95%98%eb%8a%94-%ec%9d%b4%ec%9c%a0/){: target="\_blank" }ë¼ëŠ” ì œëª©ì˜ ê¸€ì„ ì½ê²Œ ë˜ì—ˆë‹¤.

ìš”ì§€ëŠ” í˜„ì‹¤ì— ì•ˆì£¼í•˜ì§€ ë§ê³  ëŠì„ì—†ì´ ë„ì „í•´ì•¼ ì„±ì¥í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ì˜ˆì „ì²˜ëŸ¼ ì„±ì¥ì— ëª©ë©”ì§€ëŠ” ì•Šì§€ë§Œ ê·¸ë ‡ë‹¤ê³  í˜„ì‹¤ì— ì•ˆì£¼í•˜ê³  ì‹¶ì€ ë§ˆìŒì€ ì—†ê¸°ì— í•´ë‹¹ ê¸€ì—ì„œ ë§í•´ì£¼ëŠ” ì—¬ëŸ¬ ì¡°ì–¸ë“¤ì„ ì˜ ìƒˆê²¨ë†”ì•¼ê² ë‹¤.

## ì •ë³´ í†µì‹  ìš©ì–´ ì‚¬ì „

ìµœê·¼ íŠ¹ì • ìš©ì–´ì— ëŒ€í•œ ì˜ì–´ëª…ì¹­ì„ ì°¾ë˜ ì¤‘ [ì •ë³´ í†µì‹  ìš©ì–´ ì‚¬ì „](http://terms.tta.or.kr/main.do){: target="\_blank" }ì´ë¼ëŠ” ì‚¬ì´íŠ¸ë¥¼ ë°œê²¬í•˜ê²Œ ë˜ì—ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ìš°ë¦¬ê°€ ì‚¬ìš©í•˜ë˜ ë‹¨ì–´ë“¤ì„ ì˜ì–´ì™€ í•¨ê»˜ ì„¤ëª…í•´ì£¼ë¯€ë¡œ ìœ ìš©í•˜ê²Œ ì¨ë³¼ ìˆ˜ ìˆì„ê±° ê°™ë‹¤.

## Undertow access logging ì„¤ì • ë°©ë²•

Spring Bootì—ì„œ Embedded Undertowì˜ Access Logë¥¼ ì„¤ì •í•˜ëŠ” ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ë‹¤.

```yml

undertow access logging ì„¤ì • ë°©ë²•

server:
  undertow:
    accesslog:
      enabled: true
      dir: /tmp/
      pattern: '%t[%{i,X-Forwarded-For}(%a)] | [%m %U][%s %Dms][%bbytes] | [%{i,User-Agent}]'
    options:
      server:
        record-request-start-time: true
```

ê¸°ë³¸ì ìœ¼ë¡œ ì •ì˜ëœ íŒ¨í„´ì´ ìˆìœ¼ë‹ˆ í•´ë‹¹ íŒ¨í„´ì€ [Wiki](https://kb.novaordis.com/index.php/Undertow_WildFly_Subsystem_Configuration_-_access-log){: target="\_blank" }ë¥¼ ì°¸ê³ í•˜ì.

## logbackì„ xmlì´ ì•„ë‹Œ class fileë¡œ ì„¤ì •í•˜ëŠ” ë°©ë²•

Spring Bootì—ì„œ Logbakì„ ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ êµ¬ê¸€ë§í•´ë³´ë©´ ëŒ€ë¶€ë¶„ xmlì„ ì´ìš©í•œ ì„¤ì • ë°©ë²•ë§Œ ì•Œë ¤ì¤€ë‹¤. ìµœê·¼ì—ëŠ” Class fileì„ ì´ìš©í•œ ì„¤ì •ì„ í•˜ëŠ” ì¶”ì„¸ì¸ë° Logbackë§Œ ìœ ë‹¬ë¦¬ xmlë¡œ ì„¤ì •í•˜ëŠ” ê²½ìš°ê°€ ëŒ€ë¶€ë¶„ì¸ê±° ê°™ë‹¤. ê·¸ë˜ì„œ Classë¡œ ì •ì˜í•˜ëŠ” ë°©ë²•ì„ ì ì–´ë³¸ë‹¤.

```kotlin
@Configuration
class LogConfig {
    private val context = LoggerFactory.getILoggerFactory() as LoggerContext
    private val defaultLogPattern = "[user] %-5level: [%d{YYYY-MM-DD HH:mm:ss}] %msg%n"

    val filePath = "/tmp/"
    val namePattern = ".%d{yyyy-MM-dd}-%i"
    val fileName = "system_log"
    val ext = ".log"

    init {
        val rootLogger = context.getLogger(ROOT_LOGGER_NAME)
        rootLogger.level = Level.INFO
        rootLogger.addAppender(consoleAppender())
        rootLogger.addAppender(fileAppender())
    }

    private fun consoleAppender(): ConsoleAppender<ILoggingEvent> {
        val appender = ConsoleAppender<ILoggingEvent>()
        appender.context = context
        appender.name = "CONSOLE"
        appender.encoder = encoder(defaultLogPattern)
        appender.start()
        return appender
    }

    private fun fileAppender(): RollingFileAppender<ILoggingEvent> {
        val appender = RollingFileAppender<ILoggingEvent>()
        appender.context = context
        appender.name = "FILE"
        appender.encoder = encoder(defaultLogPattern)
        appender.file = filePath + fileName + ext
        appender.isAppend = false
        appender.rollingPolicy = rollingPolicy(appender)
        appender.start()
        return appender
    }

    private fun rollingPolicy(appender: RollingFileAppender<ILoggingEvent>): SizeAndTimeBasedRollingPolicy<RollingPolicy> {
        val policy = SizeAndTimeBasedRollingPolicy<RollingPolicy>()
        policy.context = context
        policy.setParent(appender)
        policy.fileNamePattern = filePath + fileName + namePattern + ext
        policy.maxHistory = 14
        policy.setMaxFileSize(FileSize.valueOf("10MB"))
        policy.start()
        return policy
    }

    private fun encoder(pattern: String): PatternLayoutEncoder {
        val encoder = PatternLayoutEncoder()
        encoder.context = context
        encoder.pattern = pattern
        encoder.start()
        return encoder
    }
}
```

## Graceful shutdownì˜ ê¸°ë³¸ ëŒ€ê¸° ì‹œê°„

Spring bootì˜ Graceful Shutdownì˜ ê¸°ë³¸ ëŒ€ê¸°ì‹œê°„ì€ ì–¼ë§ˆì¼ê¹Œ? 30ì´ˆì´ë‹¤. ê¸°ì–µí•´ë‘ì.

ì¶œì²˜: [https://www.baeldung.com/spring-boot-web-server-shutdown](https://www.baeldung.com/spring-boot-web-server-shutdown){: target="\_blank" }

## Embedded Undertow warning

Embedded Undertowë¥¼ ì„¤ì •í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ warningì´ ëœ¨ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

![undertow_warning](/assets/images/retrospective/undertow_warning.png)

í° ë¬¸ì œëŠ” ì—†ëŠ”ë° Warningì„ ê·¸ëŒ€ë¡œ ë‘ëŠ”ê±´ ë¶ˆí¸í•˜ë‹ˆ ì œê±°í•´ì£¼ë©´ ì¢‹ë‹¤. ì•„ë˜ì™€ ê°™ì´ Gradleì— ì„¤ì •í•˜ë©´ ì œê±°í•  ìˆ˜ ìˆë‹¤.

```kotlin
implementation("org.springframework.boot:spring-boot-starter-undertow") {
    exclude(group = "io.undertow", module = "undertow-websockets-jsr")
}
```

